FROM gpt-oss:20b

# 1) Deterministic-ish sampling
PARAMETER temperature 0.1
PARAMETER top_p 0.9
PARAMETER top_k 40
PARAMETER repeat_penalty 1.15
PARAMETER repeat_last_n 128
PARAMETER seed 42
PARAMETER num_ctx 16384
PARAMETER num_predict 2048

# 2) Reasoning and verbosity
# GPT-OSS supports reasoning levels via system prompt. :contentReference[oaicite:3]{index=3}
SYSTEM """
You are a local coding agent used by OpenCode.

Reasoning: medium

Constraints:
- Think step-by-step but KEEP your internal reasoning short and focused.
- You MUST obey tool-calling instructions from the client exactly.
- Never expose chain-of-thought or low-level reasoning unless explicitly asked by the system messages.
"""

# Optional: if you see tool JSON leaking into natural replies,
# you can add stop tokens that match the OpenAI tool preamble,
# but usually OpenCode/AI SDK handles this.
